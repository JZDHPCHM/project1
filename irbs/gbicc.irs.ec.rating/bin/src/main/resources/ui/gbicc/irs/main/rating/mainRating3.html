
<!DOCTYPE html>
<html th:replace="template/inspinia_singlemenu/inspinia.html::html">
<head>
<title>中关村租赁客户主体成长性评级报告</title>
<style type="text/css">
	.title{
		color: #333;
	    font-size: 18px;
	    font-weight: normal;
	    padding-bottom: 10px;
	    border-bottom: 1px solid #f2f2f2;
	}
	.top-navigation{
 display: none;
} 
	table {
		width: 100%;
		font-size: 12px;
		border: 1px solid #DDDDDD;
		margin-bottom: 20px;
	}
	.ordinary tr{
		height: 30px;
		background: #D9E5FF;
	}
	.ordinary tr td {
		padding: 6px;
	}
	.ordinary tr td.ziduan {
		font-weight: bolder;
    	color: #000;
	}
	.ui-state-default, .ui-widget-content .ui-state-default {
    	font-weight: normal;
    	font-size: 12px;
	}
	.ui-state-highlight, .ui-widget-content .ui-state-highlight{
		background: #fff;
	}
	.comp-name{
		    font-size: 24px;
	    font-weight: bolder;
	    display: inline-block;
	    color: #333;
	    margin-right: 12px;
	}
	.info-head {
 padding: 34px 0 10px;
 text-align: center;
}
	.info-span{
		padding: 2px 6px;
	    color: #666;
	    font-size: 14px;
	}
	.info-span.front-three{
		background: #f0f4fe;
	}
	.info-span.behind-two{
		background: #fef0f0;
	}
	.ziduan{
		    width: 121px;
    display: inline-block;
	    font-weight: bolder;
	    color: #333;
	}
	.ziduan-txt{
		    color: #666;
    font-size: 14px;
	}
	.level{
		color: #4680ff;
	    font-size: 50px;
	    font-weight: bolder;
	    display: inline;
	}
	.dateTime{
		font-size: 16px;
	}
	.score{
		color: #333;
	    font-size: 30px;
	    font-weight: bolder;
	    display: inline;
	}
	.name{
		    color: #666;
    font-size: 20px;
    font-weight: normal;
	}
	.right-content{
		    display: inline-block;
	    padding: 10px 40px 5px 5px;
	}
	.right-content .pointer{
		margin-left: 32%;
	    margin-top: -5px;
	    padding-bottom: 3px;
	}
	.info-block, .info-list, .right-info-list, .info-div {
		display: inline-block;
	}
	.info-block1 {
 width: 22%;
 line-height: 99px;
 height: 214px;
 position: relative;
 top: -22px;
}
	.info-block2 {
 width: 77%;
 padding-left: 2%;
}
	.bottom-three-block{
		margin-top: 15px;
	}
	.bottom-info-left {
 display: inline-block;
 width: 270px;
 height: 80px;
 border: 1px solid #d8e0f0;
 border-radius: 5px;
}
	.inner-info-left{
		        display: inline-block;
    padding: 0 10px;
    border-right: 1px solid #e6e6e6;
    height: 80px;
    line-height: 80px;
    position: relative;
    top: -23px;
	}
	.info-detailed{
		    height: 40px;
    line-height: 40px;
        padding-left: 10px;
	}
	.inner-info-right {
 display: inline-block;
 width: 165px;
}
	.bottom-info-right {
 display: inline-block;
 width: 235px;
 height: 80px;
 border: 1px solid #d8e0f0;
 border-radius: 5px;
}
	.bottom-info-right .info-inner-left {
 display: inline-block;
 width: 175px;
 border-right: 1px solid #e6e6e6;
 padding: 0 10px;
}
	.bottom-info-right .info-inner-right{
		    display: inline-block;
    width: 54px;
    text-align: center;
	}
	.kailong{
	    width: 0;
    height: 0;
    border-right: 8px solid transparent;
    border-left: 8px solid transparent;
    border-bottom: 8px solid #666;
    position: relative;
}
	.info-block .left-info {
 display: inline-block;
 text-align: center;
 border-right: 1px solid #e6e6e6;
}
	.info-block .right-info{
		    display: inline-block;
	    color: #333;
	    font-weight: 700;
	    padding: 0 15px;
	    margin-right: 10px;
	    position: relative;
	    float: left;
	}
	.info-level {
		padding-right: 10px;
    	font-size: 16px;
	}
	.info-txt{
		    font-size: 16px;
    letter-spacing: 2px;
	}
	.bottom-info-right .info-inner-left .block-diff {
		display: inline-block;
	    width: 30px;
	    height: 25px;
	    float: left;
	}
	.bottom-info-right .info-inner-left .progress-line{
		        width: 2px;
    height: 25px;
    background-color: #fff;
    display: inline-block;
    position: relative;
    left: -120px;
	}
	.bottom-info-right .info-inner-left .block1{
		background-color: #FACD91;
	}
	.bottom-info-right .info-inner-left .block2{
		background-color: #F59A23;
	}
	.bottom-info-right .info-inner-left .block3{
		width: 60px;
		background-color: #D9001B;
	}
	.info-inner-txt{
		    height: 40px;
    line-height: 40px;
	}
	.sort-progress{
		width: 120px;
		height: 25px;
		background: -moz-linear-gradient(left, #6ee802, #6ae100, #67d902, #61cd00, #5abf00,#55b400,#50aa01,#4a9c00,#479501,#418a00);
		background: -webkit-linear-gradient(left, #6ee802, #6ae100, #67d902, #61cd00, #5abf00,#55b400,#50aa01,#4a9c00,#479501,#418a00);
		background: -o-linear-gradient(left, #6ee802, #6ae100, #67d902, #61cd00, #5abf00,#55b400,#50aa01,#4a9c00,#479501,#418a00);
	}
	.right-txt{
		    height: 40px;
    line-height: 40px;
	}
	.diff-list{
		font-size: 12px;
	}
	.diff-list .diff-txt{
		display: inline-block;
	}
	.right-info-list .diff-count{
		display: inline-block;
	    position: relative;
	    top: -7px;
	}
	.score-table{
		margin-bottom: -1px;
	}
	.score-table tr{
		height: 33px;
		background: #1b62fe;
    	color: #fff;
	}
	.jqgrid_table_score .ui-widget-content .ui-state-default {
		background: #e3ecff;
	}
</style>
</head>
<body>
	<div id="wrapper" style="margin-left: 0;">
		<div id="page-wrapper" class="gray-bg">
			<!-- 菜单开始end -->
			<div class="wrapper wrapper-content">
				<div class="row">
	                <div class="col-lg-12">
	            		<div class="title">中关村租赁客户主体成长性评级报告</div>
	            		<div class="info-head">
	            			<div class="comp-name" id="custName"></div>
	            			<div class="info-div">
	            				<span class="info-span front-three" id="modelName">通用-生产型企业</span>
	            				<span class="info-span front-three" id="">园区开发</span>
	            				<span class="info-span front-three" id="ratingType">大环境事业部</span>
	            				<span class="info-span behind-two" id="firRep">定性定量差异大</span>
	            				<span class="info-span behind-two" id="">排序分位数较低</span>
	            			</div>
	            		</div>
	            		<div class="row" style="padding-bottom: 10px;">
	                		<div>
	                			<div class="info-block info-block1">
	                				<div class="left-info" style="padding-right: 10px;">
	                					<div class="level" id="endLevel"></div>
	                					<div class="dateTime" id="internDate"></div>
	                				</div>
	                				<div class="left-info" style="padding-left: 10px;border: 0;">
	                					<div class="score" id="sco"></div>
	                					<div class="name" id="finalName2"></div>
	                				</div>
	                			</div>
	                			<div class="info-block info-block2">
	                				<div class="info-txt" style="min-height: 50px; padding: 21px 0 35px;"><span class="ziduan">等级描述</span><span id="admissionSuggest" class="ziduan-txt"></span></div>
	                				<div class="info-txt"><span class="ziduan">复核人意见</span><span id="finalAdvice" class="ziduan-txt"></span></div>
	                				<div class="bottom-three-block">
	                					<div class="bottom-info-left">
		                					<div class="inner-info-left">
		                						<div>初评复核差异</div>
		                					</div>
		                					<div class="inner-info-right">
		                						<div class="info-detailed" style="border-bottom: 1px solid #e6e6e6;"><span class="info-level" id="finalLevel"></span><span style="padding-right: 10px;">初评人</span><span id="internName"></span></div>
			                					<div class="info-detailed"><span class="info-level" id="internLevel" style="color: red;"></span><span style="padding-right: 10px;">复核人</span><span id="finalName"></span></div>
		                					</div>
		                				</div>
		                				<div class="bottom-info-right">
		                					<div class="info-inner-left">
			                					<div class="info-inner-txt">定性定量差异</div>
			                					<div style="display: inline-flex;">
			                						<div class="block-diff block1"></div>
				                					<div class="block-diff block2"></div>
				                					<div class="block-diff block3"></div>
				                					<div class="progress-line" id="differencesLine"></div>
			                					</div>
			                					<div class="kailong" id="differencesTriangle"></div>
			                				</div>
			                				<div class="info-inner-right">
			                					<div id="" class="right-txt" style="border-bottom: 1px solid #e6e6e6;">较大</div>
			                					<div id="bl" class="right-txt">0%</div>
			                				</div>
		                				</div>
		                				<div class="bottom-info-right">
		                					<div class="info-inner-left">
			                					<div class="info-inner-txt">排序分位数</div>
			                					<div style="display: inline-flex;">
			                						<div class="sort-progress"></div>
				                					<div class="progress-line" id=""></div>
			                					</div>
			                					<div class="kailong" id=""></div>
			                				</div>
			                				<div class="info-inner-right">
			                					<div id="" class="right-txt" style="border-bottom: 1px solid #e6e6e6;">排名</div>
			                					<div id="" class="right-txt">70%</div>
			                				</div>
		                				</div>
	                				</div>
	                			</div>	
	                		</div>
	                	</div>
						<div class="jqGrid_wrapper">
                            <table id="table_list"></table>
                            <div id="pager_list"></div>
                        </div>
                        <!-- 模态窗口 -->
                        <div class="modal inmodal fade" id="modalScoringDetails" tabindex="-1" role="dialog"  aria-hidden="true">
                             <div class="modal-dialog modal-lg">
                                 <div class="modal-content" style="height: 100%;">
                                     <div class="modal-header">
                                         <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                                         <h4 class="modal-title"></h4>
                                     </div>
                                     <div class="modal-body">
										<table border="1" class="score-table">
											<tbody>
												<tr>
													<td style="width: 15%;" align="center">一级指标</td>
													<td style="width: 35%;" align="center">定量指标</td>
													<td style="width: 15%;" align="center">二级指标</td>
													<td style="width: 35%;" align="center">政策导向</td>
												</tr>
											</tbody>
										</table>
										<div class="jqGrid_wrapper jqgrid_table_score"><table id="score_table"></table></div>                                   		    
                                     </div>
                                     <div class="modal-footer">
                                         <button type="button" class="btn btn-danger" data-dismiss="modal">关闭</button>
                                     </div>
                                 </div>
                             </div>
                        </div>    	    
	                </div>
		        </div>
			</div>
		</div>
	</div>
</body>
<script type="text/javascript">
	$('.chosen-select').chosen({width: "100%"});
	$(document).ready(function(){
		var mydata = [];
		  $.ajax({
			url: "/irs/ratingMainStep/custInfo", 
			data:{Custno:"[[${custNo}]]"},
			async:false,
			success: function(result){
				$("#custName").text(result.response.data[0].custName);
				$("#modelName").text(result.response.data[0].type);
				$("#endLevel").text(result.response.data[0].finalLevel);
				var sco = result.response.data[0].sco;
				if(sco){
					sco = sco*1;  // 输出结果为 2.45
					$("#sco").text(sco.toFixed(2));
				}else{
					$("#sco").text(NaN);
				}
				
				$("#admissionSuggest").text(result.response.data[0].admissionSuggest);
				$("#finalLevel").text(result.response.data[0].finalLevel);
				$("#internName").text(result.response.data[0].internName);
				$("#finalName").text(result.response.data[0].finalName);
				$("#internDate").text(result.response.data[0].internDate);
				$("#internLevel").text(result.response.data[0].internLevel);
				$("#finalAdvice").text(result.response.data[0].finalAdvice);
				$("#firRep").text(result.response.data[0].firRep);
				$("#ratingType").text(result.response.data[0].ratingType);
				$("#modelName").text(result.response.data[0].type);
				$("#finalName2").text(result.response.data[0].finalName);
				var bl = result.response.data[0].bl;
				console.log(bl);
				if(bl){
					bl = bl*100;  // 输出结果为 2.45
					$("#bl").text(bl.toFixed(2)+"%");
					$("#differencesLine").css("left",bl+"px");
					$("#differencesTriangle").css("left",bl+"px");
					//$("#differencesTriangle").css("left","$('#bl')");
				}else{
					$("#sco").text("NaN");
				}
				
				mydata=result.response.data[0].generate;
	      }}) 
		$("#table_list").jqGrid({
			url : "/irs/ratingMainStep/custInfo",
			recordtext: "显示：{0} - {1}，总数：{2} ",
		    emptyrecords: "本次查询无数据！",
		    loadtext: "读取中...",
		    pgtext : "第 {0}页， 共{1}页",
			mtype : "post",
	        //datatype: "json",
	        data: mydata,
	        datatype: "local",
	        height: "100%",
	        autowidth: true,
	        shrinkToFit: true,
	        prmNames: {
	            page: "page"   // 表示请求页码的参数名称
	        },
	        rowNum: 20,
	        rowList: [10, 20, 30],
	        colNames:['一级指标','二级指标','得分','标准分值','得分比例','同业存量客户得分', '行业偏离度', '得分明细'],
	        colModel:[
	        	{name:'indextype',index:'indextype', sortable: false,
					cellattr: function(rowId, tv, rawObject, cm, rdata) {
					//合并单元格（跨行）
					return 'id=\'indextype' + rowId + "\'";
				}},
				{name:'name',index:'name', editable: true, sortable: false, formatter:function(rowId, index, rawObjec){
	            	var result =rawObjec.score/rawObjec.standardScore;
            		result=result*100;
            		result=result.toFixed(2); 
            		if(result<50){
            			var html ="<span style='color:red;'>"+rawObjec.name+"</span>"
            			return html;
            		}else{
            			return rawObjec.name;
            		}
	            }},
	            {name:'score',index:'score', editable: true, sortable: false, formatter:function(rowId, index, rawObjec){
	            	var result =rawObjec.score/rawObjec.standardScore;
            		result=result*100;
            		result=result.toFixed(2); 
            		var result1=rowId*1.0;
	            	result1=result1.toFixed(2); 
            		if(result<50){
    	            	var html ="<span style='color:red;'>"+result1+"</span>"
            			return html;
            		}else{
            			return result1;
            		}
            	}},
	            {name:'standardScore',index:'scoreDivergence', editable: true, sortable: false, formatter:function(rowId, index, rawObjec){
	            	
	            	var result =rawObjec.score/rawObjec.standardScore;
            		result=result*100;
            		result=result.toFixed(2); 
            		var result1=rowId*1.0;
	            	result1=result1.toFixed(2); 
            		if(result<50){
    	            	var html ="<span style='color:red;'>"+result1+"</span>"
            			return html;
            		}else{
            			return result1;
            		}
            	}},
	            {name:'scoreProportion',index:'scoreProportion', editable: true, sortable: false,
	            	formatter:function(rowId, index, rawObjec){
	            		var result =rawObjec.score/rawObjec.standardScore;
	            		result=result*100;
	            		result=result.toFixed(2); 
	            		if(result<50){
	            			var html ="<span style='color:red;'>"+result+"%</span>"
	            			return html;
	            		}else{
	            			return result+"%";
	            		}
	            	}},
	            {name:'scoreAvg',index:'scoreAvg', editable: true, sortable: false, formatter:function(rowId, index, rawObjec){
	            	var result=rowId*1.0;
	            	result=result.toFixed(2); 
            		return result;
            	}},
	            {name:'scoreDivergence',index:'scoreDivergence', editable: true, sortable: false,
	            	formatter:function(rowId, index, rawObjec){
	            		var f9=rawObjec.score/rawObjec.standardScore;
	            		var result =(rawObjec.score-f9)/f9;
	            		result=result*100;
	            		result=result.toFixed(2); 
	            		if(result<-30){
	            			var html ="<span style='color:red;'>"+result+"%</span>"
	            			return html;
	            		}else{
	            			return result+"%";
	            		}
	            	}},
	            {name:'name',index:'name', editable: true, sortable: false, formatter:function(rowId, index, rawObjec){
	            	var result =rawObjec.score/rawObjec.standardScore;
            		result=result*100;
            		result=result.toFixed(2); 
            		if(result<50){
            			var html ="<span style='color:red;text-decoration: underline;cursor: pointer;' onclick='showMoreInfo()'>"+rawObjec.name+"</span>"
            			return html;
            		}else{
            			var html ="<span style='text-decoration: underline;cursor: pointer;' onclick='showMoreInfo()'>"+rawObjec.name+"</span>"
            			return html;
            			//return rawObjec.name;
            		}
	            }}
	        ],
	        //pager: "#pager_list",
	        sortable: false,
	        viewrecords: true,
	        caption: "",
	        gridComplete: function() {
				//在gridComplete调用合并方法
				var gridName = "table_list";
				MergerRowspan(gridName, 'indextype');//跨行
			},
	        add: true,
	        edit: true,
	        addtext: 'Add',
	        edittext: 'Edit',
	        //rownumbers: true,
	        //rownumWidth: 60,
	        hidegrid: false,
	        jsonReader: {
	        	root: "data",
	        	records: "recordsTotal",
	        	repeatitems: false,
	        	id: "0"
	        }
	    });
		  var mydata2 = [];
		  $("#score_table").jqGrid({
				url : "",
				recordtext: "显示：{0} - {1}，总数：{2} ",
			    emptyrecords: "本次查询无数据！",
			    loadtext: "读取中...",
			    pgtext : "第 {0}页， 共{1}页",
				mtype : "post",
		        data: mydata2,
		        datatype: "local",
		        width: 836,
		        height: "100%",
		        autowidth: false,
		        shrinkToFit: true,
		        prmNames: {
		            page: "page"   // 表示请求页码的参数名称
		        },
		        rowNum: 20,
		        rowList: [10, 20, 30],
		        colNames:['指标名称','指标值','指标得分','指标值描述'],
		        colModel:[
		        	{name:'FD_INDEXNAME',index:'FD_INDEXCATEGORY', sortable: false, sortable: false},
					{name:'FD_INDEXVALUE',index:'FD_INDEXVALUE', editable: true, sortable: false,width: 50,formatter:function(value,row,index){
						if(!isNaN(value)){　　　
							var result=value*1.0;
			            	result=result.toFixed(2); 
		            		return result;
							}else{
								 return value; 
							}

					}},
		            {name:'FD_SCORE',index:'FD_SCORE', editable: true, sortable: false,width: 50,formatter:function(value,row,index){
		            	if(!isNaN(value)){　　　
							var result=value*1.0;
			            	result=result.toFixed(2); 
		            		return result;
							}else{
								 return value; 
							}
		            }},
		            {name:'FD_QUALITATIVE_OPTIONS',index:'FD_QUALITATIVE_OPTIONS', editable: true, sortable: false}
		        ],
		        viewrecords: true,
		        caption: "",
		        add: true,
		        edit: true,
		        addtext: 'Add',
		        edittext: 'Edit',
		        rownumbers: true,
		        rownumWidth: 60,
		        hidegrid: false,
		        jsonReader: {
		        	root: "data",
		        	records: "recordsTotal",
		        	repeatitems: false,
		        	id: "0"
		        }
		    });  
		$("#score_table").jqGrid('setLabel','rn','序号',{'text-align':'center','vertical-align':'middle'},'');
		// Setup buttons
        $("#table_list").jqGrid('navGrid', '#pager_list',
                {edit: false, add: false, del: false, search: false},
                {height: 200, reloadAfterSubmit: true}
        );
        $("#table_list").jqGrid('setGroupHeaders', {
       	    useColSpanStyle: true,
       	    groupHeaders:[
       	        {startColumnName:'indextype', numberOfColumns:2, titleText: '评价维度'}
       	    ]  
       	})
        // Add responsive to jqGrid
        $(window).bind('resize', function () {
            var width = $('.jqGrid_wrapper').width();
            $('#table_list').setGridWidth(width);
        });
	});
	function showMoreInfo(){
		/* $("body",window.parent.document).find('#tab_sheet_3_Title').trigger("click");
		debugger */
		$("#modalScoringDetails").modal();
	}
</script>
</html>
