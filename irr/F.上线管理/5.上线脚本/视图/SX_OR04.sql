CREATE OR REPLACE VIEW SX_OR04 AS
SELECT
MAX(DECODE(IOR.INDEX_CODE,'OR04001',IOR.INDEX_RESULT_Q2)) COL_1,
MAX(DECODE(IOR.INDEX_CODE,'OR04002',IOR.INDEX_RESULT_Q2)) COL_2,
MAX(DECODE(IOR.INDEX_CODE,'OR04003',IOR.INDEX_RESULT_Q2)) COL_3,
MAX(DECODE(IOR.INDEX_CODE,'OR04038',IOR.INDEX_RESULT_Q2)) COL_4,
MAX(DECODE(IOR.INDEX_CODE,'OR04039',IOR.INDEX_RESULT_Q2)) COL_5,
MAX(DECODE(IOR.INDEX_CODE,'OR04040',IOR.INDEX_RESULT_Q2)) COL_6,
MAX(DECODE(IOR.INDEX_CODE,'OR04004',IOR.INDEX_RESULT_Q2)) COL_7,
MAX(DECODE(IOR.INDEX_CODE,'OR04005',IOR.INDEX_RESULT_Q2)) COL_8,
MAX(DECODE(IOR.INDEX_CODE,'OR04006',IOR.INDEX_RESULT_Q2)) COL_9,
MAX(DECODE(IOR.INDEX_CODE,'OR04007',IOR.INDEX_RESULT_Q2)) COL_10,
MAX(DECODE(IOR.INDEX_CODE,'OR04041',IOR.INDEX_RESULT_Q2)) COL_11,
MAX(DECODE(IOR.INDEX_CODE,'OR04042',IOR.INDEX_RESULT_Q2)) COL_12,
MAX(DECODE(IOR.INDEX_CODE,'OR04043',IOR.INDEX_RESULT_Q2)) COL_13,
MAX(DECODE(IOR.INDEX_CODE,'OR04044',IOR.INDEX_RESULT_Q2)) COL_14,
MAX(DECODE(IOR.INDEX_CODE,'OR04045',IOR.INDEX_RESULT_Q2)) COL_15,
MAX(DECODE(IOR.INDEX_CODE,'OR04008',IOR.INDEX_RESULT_Q2)) COL_16,
MAX(DECODE(IOR.INDEX_CODE,'OR04009',IOR.INDEX_RESULT_Q2)) COL_17,
MAX(DECODE(IOR.INDEX_CODE,'OR04010',IOR.INDEX_RESULT_Q2)) COL_18,
MAX(DECODE(IOR.INDEX_CODE,'OR04011',IOR.INDEX_RESULT_Q2)) COL_19,
MAX(DECODE(IOR.INDEX_CODE,'OR04012',IOR.INDEX_RESULT_Q2)) COL_20,
MAX(DECODE(IOR.INDEX_CODE,'OR04046',IOR.INDEX_RESULT_Q2)) COL_21,
MAX(DECODE(IOR.INDEX_CODE,'OR04013',IOR.INDEX_RESULT_Q2)) COL_22,
MAX(DECODE(IOR.INDEX_CODE,'OR04014',IOR.INDEX_RESULT_Q2)) COL_23,
MAX(DECODE(IOR.INDEX_CODE,'OR04015',IOR.INDEX_RESULT_Q2)) COL_24,
MAX(DECODE(IOR.INDEX_CODE,'OR04047',IOR.INDEX_RESULT_Q2)) COL_25,
MAX(DECODE(IOR.INDEX_CODE,'OR04048',IOR.INDEX_RESULT_Q2)) COL_26,
MAX(DECODE(IOR.INDEX_CODE,'OR04049',IOR.INDEX_RESULT_Q2)) COL_27,
MAX(DECODE(IOR.INDEX_CODE,'OR04050',IOR.INDEX_RESULT_Q2)) COL_28,
MAX(DECODE(IOR.INDEX_CODE,'OR04051',IOR.INDEX_RESULT_Q2)) COL_29,
MAX(DECODE(IOR.INDEX_CODE,'OR04052',IOR.INDEX_RESULT_Q2)) COL_30,
MAX(DECODE(IOR.INDEX_CODE,'OR04053',IOR.INDEX_RESULT_Q2)) COL_31,
MAX(DECODE(IOR.INDEX_CODE,'OR04016',IOR.INDEX_RESULT_Q2)) COL_32,
MAX(DECODE(IOR.INDEX_CODE,'OR04017',IOR.INDEX_RESULT_Q2)) COL_33,
MAX(DECODE(IOR.INDEX_CODE,'OR04018',IOR.INDEX_RESULT_Q2)) COL_34,
MAX(DECODE(IOR.INDEX_CODE,'OR04019',IOR.INDEX_RESULT_Q2)) COL_35,
MAX(DECODE(IOR.INDEX_CODE,'OR04020',IOR.INDEX_RESULT_Q2)) COL_36,
MAX(DECODE(IOR.INDEX_CODE,'OR04072',IOR.INDEX_RESULT_Q2)) COL_37,
MAX(DECODE(IOR.INDEX_CODE,'OR04054',IOR.INDEX_RESULT_Q2)) COL_38,
MAX(DECODE(IOR.INDEX_CODE,'OR04055',IOR.INDEX_RESULT_Q2)) COL_39,
MAX(DECODE(IOR.INDEX_CODE,'OR04056',IOR.INDEX_RESULT_Q2)) COL_40,
MAX(DECODE(IOR.INDEX_CODE,'OR04057',IOR.INDEX_RESULT_Q2)) COL_41,
MAX(DECODE(IOR.INDEX_CODE,'OR04021',IOR.INDEX_RESULT_Q2)) COL_42,
MAX(DECODE(IOR.INDEX_CODE,'OR04022',IOR.INDEX_RESULT_Q2)) COL_43,
MAX(DECODE(IOR.INDEX_CODE,'OR04023',IOR.INDEX_RESULT_Q2)) COL_44,
MAX(DECODE(IOR.INDEX_CODE,'OR04024',IOR.INDEX_RESULT_Q2)) COL_45,
MAX(DECODE(IOR.INDEX_CODE,'OR04025',IOR.INDEX_RESULT_Q2)) COL_46,
MAX(DECODE(IOR.INDEX_CODE,'OR04026',IOR.INDEX_RESULT_Q2)) COL_47,
MAX(DECODE(IOR.INDEX_CODE,'OR04027',IOR.INDEX_RESULT_Q2)) COL_48,
MAX(DECODE(IOR.INDEX_CODE,'OR04028',IOR.INDEX_RESULT_Q2)) COL_49,
MAX(DECODE(IOR.INDEX_CODE,'OR04029',IOR.INDEX_RESULT_Q2)) COL_50,
MAX(DECODE(IOR.INDEX_CODE,'OR04030',IOR.INDEX_RESULT_Q2)) COL_51,
MAX(DECODE(IOR.INDEX_CODE,'OR04031',IOR.INDEX_RESULT_Q2)) COL_52,
MAX(DECODE(IOR.INDEX_CODE,'OR04032',IOR.INDEX_RESULT_Q2)) COL_53,
MAX(DECODE(IOR.INDEX_CODE,'OR04058',IOR.INDEX_RESULT_Q2)) COL_54,
MAX(DECODE(IOR.INDEX_CODE,'OR04059',IOR.INDEX_RESULT_Q2)) COL_55,
MAX(DECODE(IOR.INDEX_CODE,'OR04060',IOR.INDEX_RESULT_Q2)) COL_56,
MAX(DECODE(IOR.INDEX_CODE,'OR04061',IOR.INDEX_RESULT_Q2)) COL_57,
MAX(DECODE(IOR.INDEX_CODE,'OR04062',IOR.INDEX_RESULT_Q2)) COL_58,
MAX(DECODE(IOR.INDEX_CODE,'OR04063',IOR.INDEX_RESULT_Q2)) COL_59,
MAX(DECODE(IOR.INDEX_CODE,'OR04033',IOR.INDEX_RESULT_Q2)) COL_60,
MAX(DECODE(IOR.INDEX_CODE,'OR04064',IOR.INDEX_RESULT_Q2)) COL_61,
MAX(DECODE(IOR.INDEX_CODE,'OR04034',IOR.INDEX_RESULT_Q2)) COL_62,
MAX(DECODE(IOR.INDEX_CODE,'OR04065',IOR.INDEX_RESULT_Q2)) COL_63,
MAX(DECODE(IOR.INDEX_CODE,'OR04066',IOR.INDEX_RESULT_Q2)) COL_64,
MAX(DECODE(IOR.INDEX_CODE,'OR04067',IOR.INDEX_RESULT_Q2)) COL_65,
MAX(DECODE(IOR.INDEX_CODE,'OR04068',IOR.INDEX_RESULT_Q2)) COL_66,
MAX(DECODE(IOR.INDEX_CODE,'OR04069',IOR.INDEX_RESULT_Q2)) COL_67,
MAX(DECODE(IOR.INDEX_CODE,'OR04070',IOR.INDEX_RESULT_Q2)) COL_68,
MAX(DECODE(IOR.INDEX_CODE,'OR04071',IOR.INDEX_RESULT_Q2)) COL_69,
MAX(DECODE(IOR.INDEX_CODE,'OR04035',IOR.INDEX_RESULT_Q2)) COL_70,
MAX(DECODE(IOR.INDEX_CODE,'OR04036',IOR.INDEX_RESULT_Q2)) COL_71,
MAX(DECODE(IOR.INDEX_CODE,'OR04037',IOR.INDEX_RESULT_Q2)) COL_72,
IOR.ORG_CODE STOCK_ID,
TO_XBRL_TASK_BATCH(IOR.TASK_BATCH) REPORT_MARK_DATE
FROM T_IRR_ORG_RESULT IOR
INNER JOIN T_IRR_INDEX_INFO II ON IOR.INDEX_ID=II.ID
INNER JOIN T_IRR_PROJ_TYPE PT ON II.PROJ_TYPE_ID=PT.ID
WHERE PT.TYPE_CODE='OR04'
GROUP BY IOR.ORG_CODE,TO_XBRL_TASK_BATCH(IOR.TASK_BATCH);
