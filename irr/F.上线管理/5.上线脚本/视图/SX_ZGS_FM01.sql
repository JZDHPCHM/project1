CREATE OR REPLACE VIEW SX_ZGS_FM01 AS
SELECT
MAX(DECODE(IOR.INDEX_CODE,'FM01001',IOR.INDEX_RESULT_Q2)) COL_01,
MAX(DECODE(IOR.INDEX_CODE,'FM01002',IOR.INDEX_RESULT_Q2)) COL_02,
MAX(DECODE(IOR.INDEX_CODE,'FM01003',IOR.INDEX_RESULT_Q2)) COL_03,
MAX(DECODE(IOR.INDEX_CODE,'FM01004',IOR.INDEX_RESULT_Q2)) COL_04,
MAX(DECODE(IOR.INDEX_CODE,'FM01005',IOR.INDEX_RESULT_Q2)) COL_05,
MAX(DECODE(IOR.INDEX_CODE,'FM01006',IOR.INDEX_RESULT_Q2)) COL_06,
MAX(DECODE(IOR.INDEX_CODE,'FM01007',IOR.INDEX_RESULT_Q2)) COL_07,
MAX(DECODE(IOR.INDEX_CODE,'FM01008',IOR.INDEX_RESULT_Q2)) COL_08,
MAX(DECODE(IOR.INDEX_CODE,'FM01009',IOR.INDEX_RESULT_Q2)) COL_09,
MAX(DECODE(IOR.INDEX_CODE,'FM01010',IOR.INDEX_RESULT_Q2)) COL_10,
MAX(DECODE(IOR.INDEX_CODE,'FM01011',IOR.INDEX_RESULT_Q2)) COL_11,
MAX(DECODE(IOR.INDEX_CODE,'FM01012',IOR.INDEX_RESULT_Q2)) COL_12,
MAX(DECODE(IOR.INDEX_CODE,'FM01013',IOR.INDEX_RESULT_Q2)) COL_13,
MAX(DECODE(IOR.INDEX_CODE,'FM01014',IOR.INDEX_RESULT_Q2)) COL_14,
MAX(DECODE(IOR.INDEX_CODE,'FM01015',IOR.INDEX_RESULT_Q2)) COL_15,
MAX(DECODE(IOR.INDEX_CODE,'FM01016',IOR.INDEX_RESULT_Q2)) COL_16,
MAX(DECODE(IOR.INDEX_CODE,'FM01017',IOR.INDEX_RESULT_Q2)) COL_17,
MAX(DECODE(IOR.INDEX_CODE,'FM01018',IOR.INDEX_RESULT_Q2)) COL_18,
MAX(DECODE(IOR.INDEX_CODE,'FM01019',IOR.INDEX_RESULT_Q2)) COL_19,
MAX(DECODE(IOR.INDEX_CODE,'FM01020',IOR.INDEX_RESULT_Q2)) COL_20,
MAX(DECODE(IOR.INDEX_CODE,'FM01021',IOR.INDEX_RESULT_Q2)) COL_21,
MAX(DECODE(IOR.INDEX_CODE,'FM01022',IOR.INDEX_RESULT_Q2)) COL_22,
MAX(DECODE(IOR.INDEX_CODE,'FM01023',IOR.INDEX_RESULT_Q2)) COL_23,
MAX(DECODE(IOR.INDEX_CODE,'FM01024',IOR.INDEX_RESULT_Q2)) COL_24,
MAX(DECODE(IOR.INDEX_CODE,'FM01025',IOR.INDEX_RESULT_Q2)) COL_25,
MAX(DECODE(IOR.INDEX_CODE,'FM01026',IOR.INDEX_RESULT_Q2)) COL_26,
IOR.ORG_CODE STOCK_ID,
TO_XBRL_TASK_BATCH(IOR.TASK_BATCH) REPORT_MARK_DATE
FROM T_IRR_ORG_RESULT IOR
INNER JOIN T_IRR_INDEX_INFO II ON IOR.INDEX_ID=II.ID
INNER JOIN T_IRR_PROJ_TYPE PT ON II.PROJ_TYPE_ID=PT.ID
WHERE PT.TYPE_CODE='FM01'
GROUP BY IOR.ORG_CODE,TO_XBRL_TASK_BATCH(IOR.TASK_BATCH);
