CREATE OR REPLACE VIEW SX_ZGS_OR02 AS
SELECT
MAX(DECODE(IOR.INDEX_CODE,'OR02001',IOR.INDEX_RESULT_Q2)) COL_1,
MAX(DECODE(IOR.INDEX_CODE,'OR02002',IOR.INDEX_RESULT_Q2)) COL_2,
MAX(DECODE(IOR.INDEX_CODE,'OR02003',IOR.INDEX_RESULT_Q2)) COL_3,
MAX(DECODE(IOR.INDEX_CODE,'OR02004',IOR.INDEX_RESULT_Q2)) COL_4,
MAX(DECODE(IOR.INDEX_CODE,'OR02013',IOR.INDEX_RESULT_Q2)) COL_5,
MAX(DECODE(IOR.INDEX_CODE,'OR02014',IOR.INDEX_RESULT_Q2)) COL_6,
MAX(DECODE(IOR.INDEX_CODE,'OR02015',IOR.INDEX_RESULT_Q2)) COL_7,
MAX(DECODE(IOR.INDEX_CODE,'OR02005',IOR.INDEX_RESULT_Q2)) COL_8,
MAX(DECODE(IOR.INDEX_CODE,'OR02034',IOR.INDEX_RESULT_Q2)) COL_9,
MAX(DECODE(IOR.INDEX_CODE,'OR02006',IOR.INDEX_RESULT_Q2)) COL_10,
MAX(DECODE(IOR.INDEX_CODE,'OR02016',IOR.INDEX_RESULT_Q2)) COL_11,
MAX(DECODE(IOR.INDEX_CODE,'OR02007',IOR.INDEX_RESULT_Q2)) COL_12,
MAX(DECODE(IOR.INDEX_CODE,'OR02008',IOR.INDEX_RESULT_Q2)) COL_13,
MAX(DECODE(IOR.INDEX_CODE,'OR02009',IOR.INDEX_RESULT_Q2)) COL_14,
MAX(DECODE(IOR.INDEX_CODE,'OR02010',IOR.INDEX_RESULT_Q2)) COL_15,
MAX(DECODE(IOR.INDEX_CODE,'OR02017',IOR.INDEX_RESULT_Q2)) COL_16,
MAX(DECODE(IOR.INDEX_CODE,'OR02018',IOR.INDEX_RESULT_Q2)) COL_17,
MAX(DECODE(IOR.INDEX_CODE,'OR02019',IOR.INDEX_RESULT_Q2)) COL_18,
MAX(DECODE(IOR.INDEX_CODE,'OR02020',IOR.INDEX_RESULT_Q2)) COL_19,
MAX(DECODE(IOR.INDEX_CODE,'OR02021',IOR.INDEX_RESULT_Q2)) COL_20,
MAX(DECODE(IOR.INDEX_CODE,'OR02022',IOR.INDEX_RESULT_Q2)) COL_21,
MAX(DECODE(IOR.INDEX_CODE,'OR02023',IOR.INDEX_RESULT_Q2)) COL_22,
MAX(DECODE(IOR.INDEX_CODE,'OR02024',IOR.INDEX_RESULT_Q2)) COL_23,
MAX(DECODE(IOR.INDEX_CODE,'OR02025',IOR.INDEX_RESULT_Q2)) COL_24,
MAX(DECODE(IOR.INDEX_CODE,'OR02026',IOR.INDEX_RESULT_Q2)) COL_25,
MAX(DECODE(IOR.INDEX_CODE,'OR02027',IOR.INDEX_RESULT_Q2)) COL_26,
MAX(DECODE(IOR.INDEX_CODE,'OR02028',IOR.INDEX_RESULT_Q2)) COL_27,
MAX(DECODE(IOR.INDEX_CODE,'OR02029',IOR.INDEX_RESULT_Q2)) COL_28,
MAX(DECODE(IOR.INDEX_CODE,'OR02030',IOR.INDEX_RESULT_Q2)) COL_29,
MAX(DECODE(IOR.INDEX_CODE,'OR02031',IOR.INDEX_RESULT_Q2)) COL_30,
MAX(DECODE(IOR.INDEX_CODE,'OR02032',IOR.INDEX_RESULT_Q2)) COL_31,
MAX(DECODE(IOR.INDEX_CODE,'OR02033',IOR.INDEX_RESULT_Q2)) COL_32,
MAX(DECODE(IOR.INDEX_CODE,'OR02011',IOR.INDEX_RESULT_Q2)) COL_33,
MAX(DECODE(IOR.INDEX_CODE,'OR02012',IOR.INDEX_RESULT_Q2)) COL_34,
IOR.ORG_CODE STOCK_ID,
TO_XBRL_TASK_BATCH(IOR.TASK_BATCH) REPORT_MARK_DATE
FROM T_IRR_ORG_RESULT IOR
INNER JOIN T_IRR_INDEX_INFO II ON IOR.INDEX_ID=II.ID
INNER JOIN T_IRR_PROJ_TYPE PT ON II.PROJ_TYPE_ID=PT.ID
WHERE PT.TYPE_CODE='OR02'
GROUP BY IOR.ORG_CODE,TO_XBRL_TASK_BATCH(IOR.TASK_BATCH);
