
SELECT COUNT(DISTINCT A.PID)
  FROM E_BDS_SSA_T_PERSON A   
 INNER JOIN (SELECT DISTINCT PID, CONTRACTTYPENO FROM E_BDS_SSA_T_CONTRACT) B
    ON A.PID = B.PID
 WHERE A.ENDDATE >= TO_DATE('20180630', 'yyyymmdd')
